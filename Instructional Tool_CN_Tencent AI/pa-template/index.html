<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>表现性评估设计工具</title>
    
    <!-- 安全防护meta标签 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, noimageindex">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="referrer" content="no-referrer">
    
    <!-- 内容安全策略 -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data:; font-src 'self' https://cdn.jsdelivr.net;">
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="fonts/NotoSansSC-Regular-normal.js"></script>
    
    <!-- 额外的JavaScript保护 -->
    <script>
        // 防止iframe嵌入
        if (window.top !== window.self) {
            window.top.location = window.self.location;
        }
        
        // 禁用调试器
        setInterval(function() {
            debugger;
        }, 100);
        
        // 检测控制台
        let devtools = false;
        let element = new Image();
        Object.defineProperty(element, 'id', {
            get: function() {
                devtools = true;
                throw new Error('Developer tools detected!');
            }
        });
        
        setInterval(function() {
            devtools = false;
            console.log(element);
            if (devtools) {
                document.body.innerHTML = '<div style="text-align:center;margin-top:200px;font-size:24px;color:#ff0000;">访问被拒绝</div>';
            }
        }, 1000);
    </script>
</head>
<body>
    <svg class="top-wave" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 180">
        <path fill="#64b5f6" fill-opacity="0.5" d="M0,128L48,117.3C96,107,192,85,288,90.7C384,96,480,128,576,154.7C672,181,768,203,864,186.7C960,171,1056,117,1152,96C1248,75,1344,85,1392,90.7L1440,96L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z"></path>
    </svg>
    
    <div class="container">
        <header class="app-header">
            <div class="school-title">
                <div class="school-cn">深圳明湾学校</div>
                <div class="school-en">SHENZHEN MINGWAN SCHOOL</div>
            </div>
            <h1 class="page-title">表现性评估任务计划</h1>
        </header>

        <div class="app-intro">
            本工具帮助教师设计高质量的表现性评估任务，明确学习目标、评分标准和证据收集方法。
            完成所有步骤后，您可以下载完整的评估计划文档。
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-step step-active">
                    <div class="step-icon">1</div>
                    <div class="step-label">基本信息</div>
                </div>
                <div class="progress-step">
                    <div class="step-icon">2</div>
                    <div class="step-label">学习目标</div>
                </div>
                <div class="progress-step">
                    <div class="step-icon">3</div>
                    <div class="step-label">评估设计</div>
                </div>
                <div class="progress-step">
                    <div class="step-icon">4</div>
                    <div class="step-label">能力指标</div>
                </div>
                <div class="progress-step">
                    <div class="step-icon">5</div>
                    <div class="step-label">完成</div>
                </div>
            </div>
        </div>

        <form id="paForm">
            <!-- Basic Information Card -->
            <div class="app-card">
                <div class="card-header">
                    <div class="card-icon"><i class="bi bi-info-circle-fill"></i></div>
                    <div class="card-title">基本信息</div>
                    <div class="card-counter">1</div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="gradeSelect">年级:</label>
                    <div class="select-wrapper">
                        <select id="gradeSelect" name="grade" class="form-control">
                            <option value="">选择年级</option>
                            <option value="1">一年级</option>
                            <option value="2">二年级</option>
                            <option value="3">三年级</option>
                            <option value="4">四年级</option>
                            <option value="5">五年级</option>
                            <option value="6">六年级</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="unitName">单元名称:</label>
                    <input type="text" id="unitName" name="unitName" class="form-control" placeholder="输入单元名称">
                    <div class="form-help">请输入本次评估任务的教学单元名称</div>
                </div>
            </div>

            <!-- Learning Goals Card -->
            <div class="app-card">
                <div class="card-header">
                    <div class="card-icon"><i class="bi bi-target"></i></div>
                    <div class="card-title">学习目标与标准</div>
                    <div class="card-counter">2</div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="learningObjectives">学习目标/标准:</label>
                    <textarea id="learningObjectives" name="learningObjectives" class="form-control" placeholder="输入学习目标/标准"></textarea>
                    <div class="form-help">您可以从标准库中选择或手动输入自定义学习目标</div>

                    <div class="standards-selector">
                        <div class="select-wrapper">
                            <select id="gradeSelectStandards" class="form-control">
                                <option value="">选择年级</option>
                                <option value="1">一年级</option>
                                <option value="2">二年级</option>
                                <option value="3">三年级</option>
                                <option value="4">四年级</option>
                                <option value="5">五年级</option>
                                <option value="6">六年级</option>
                                <option value="7">七年级</option>
                            </select>
                        </div>
                        <div class="select-wrapper">
                            <select id="subjectSelectStandards" class="form-control">
                                <option value="">选择科目</option>
                                <option value="Math">数学</option>
                                <option value="English">英语</option>
                                <option value="PE">体育</option>
                                <option value="Music">音乐</option>
                            </select>
                        </div>
                        <div class="select-wrapper">
                            <select id="standardsSelect" class="form-control">
                                <option value="">选择标准</option>
                            </select>
                        </div>
                    </div>

                    <button type="button" id="aiEditButton1" class="btn-ai" data-target="learningObjectives">
                        <i class="bi bi-magic"></i> AI优化学习目标
                    </button>
                    <span id="aiEditSpinner1" class="ai-progress" style="display:none;">
                        <span class="spinner"></span> 优化中...
                    </span>
                    <textarea id="learningObjectivesAiSuggestion" name="learningObjectivesAiSuggestion" class="form-control mt-2" rows="5" style="display: none;"></textarea>
                    <button type="button" id="applyLearningObjectives" class="btn btn-success mt-2" style="display: none;">应用优化结果</button>
                </div>

                <div class="form-group">
                    <label class="form-label" for="essentialQuestions">核心问题:</label>
                    <textarea id="essentialQuestions" name="essentialQuestions" class="form-control" placeholder="输入核心问题"></textarea>
                    <div class="form-help">好的核心问题能引导学生思考并展示理解</div>
                    
                    <button type="button" id="aiEditButton2" class="btn-ai" data-target="essentialQuestions">
                        <i class="bi bi-magic"></i> AI优化核心问题
                    </button>
                    <span id="aiEditSpinner2" class="ai-progress" style="display:none;">
                        <span class="spinner"></span> 优化中...
                    </span>
                    <textarea id="essentialQuestionsAiSuggestion" name="essentialQuestionsAiSuggestion" class="form-control mt-2" rows="3" style="display: none;"></textarea>
                    <button type="button" id="applyEssentialQuestions" class="btn btn-success mt-2" style="display: none;">应用优化结果</button>
                </div>
            </div>

            <!-- Assessment Design Card -->
            <div class="app-card">
                <div class="card-header">
                    <div class="card-icon"><i class="bi bi-clipboard-check"></i></div>
                    <div class="card-title">评估设计</div>
                    <div class="card-counter">3</div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="backgrounds">背景(真实情境):</label>
                    <textarea id="backgrounds" name="backgrounds" class="form-control" placeholder="输入评估背景/真实情境"></textarea>
                    <div class="form-help">描述学生将展示能力的真实情境</div>
                    
                    <button type="button" id="aiEditButton3" class="btn-ai" data-target="backgrounds">
                        <i class="bi bi-magic"></i> AI优化背景描述
                    </button>
                    <span id="aiEditSpinner3" class="ai-progress" style="display:none;">
                        <span class="spinner"></span> 优化中...
                    </span>
                    <textarea id="backgroundsAiSuggestion" name="backgroundsAiSuggestion" class="form-control mt-2" rows="3" style="display: none;"></textarea>
                    <button type="button" id="applyBackgrounds" class="btn btn-success mt-2" style="display: none;">应用优化结果</button>
                </div>

                <div class="form-group">
                    <label class="form-label" for="paDescription">评估任务描述:</label>
                    <textarea id="paDescription" name="paDescription" class="form-control" placeholder="输入详细的评估任务描述"></textarea>
                    <div class="form-help">详细说明学生需要完成的任务内容和要求</div>
                    
                    <button type="button" id="aiEditButton4" class="btn-ai" data-target="paDescription">
                        <i class="bi bi-magic"></i> AI优化任务描述
                    </button>
                    <span id="aiEditSpinner4" class="ai-progress" style="display:none;">
                        <span class="spinner"></span> 优化中...
                    </span>
                    <textarea id="paDescriptionAiSuggestion" name="paDescriptionAiSuggestion" class="form-control mt-2" rows="5" style="display: none;"></textarea>
                    <button type="button" id="applyPaDescription" class="btn btn-success mt-2" style="display: none;">应用优化结果</button>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="imageUpload">上传图片:</label>
                    <div class="upload-container">
                        <label for="imageUpload" class="upload-btn">
                            <i class="bi bi-upload"></i> 选择文件
                        </label>
                        <input type="file" id="imageUpload" accept="image/png" style="display: none;">
                        <span class="upload-text" id="file-selected">未选择文件</span>
                    </div>
                    <div class="form-help">请上传与评估任务相关的图片或示例</div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="artifactsEvidence">学习成果/证据：</label>
                    <textarea id="artifactsEvidence" name="artifactsEvidence" class="form-control" placeholder="Enter student deliverables, final products, or evidence"></textarea>
                    <div class="form-help">描述学生需要提交的学习成果或相关证据</div>
                    
                    <button type="button" id="aiEditButton5" class="btn-ai" data-target="artifactsEvidence">
                        <i class="bi bi-magic"></i> AI优化成果/证据描述
                    </button>
                    <span id="aiEditSpinner5" class="ai-progress" style="display:none;">
                        <span class="spinner"></span> 优化中...
                    </span>
                    <textarea id="artifactsEvidenceAiSuggestion" name="artifactsEvidenceAiSuggestion" class="form-control mt-2" rows="5" style="display: none;"></textarea>
                    <button type="button" id="applyArtifactsEvidence" class="btn btn-success mt-2" style="display: none;">Apply</button>
                </div>
            </div>

            <!-- Competency Indicators Card -->
            <div class="app-card">
                <div class="card-header">
                    <div class="card-icon"><i class="bi bi-stars"></i></div>
                    <div class="card-title">核心素养指标</div>
                    <div class="card-counter">4</div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="competencySelect">核心素养:</label>
                    <div class="select-wrapper">
                        <select id="competencySelect" name="competency" class="form-control">
                            <option value="">选择核心素养</option>
                            <option value="1">核心素养1：文化素养与全球视野</option>
                            <option value="2">核心素养2：批判性思维与创新</option>
                            <option value="3">核心素养3：领导力与合作</option>
                            <option value="4">核心素养4：情绪韧性与健康</option>
                            <option value="5">核心素养5：道德责任与服务</option>
                            <option value="6">核心素养6：沟通与表达</option>
                        </select>
                    </div>
                    <div class="form-help">请选择本次评估任务要培养的核心素养</div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="competencyIndicators">素养指标:</label>
                    <div id="competencyIndicatorsContainer" class="competency-indicators">
                        <p>请选择核心素养以查看相关指标</p>
                    </div>
                    <div class="form-help">请选择要评估的具体素养指标</div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="rubricsDisplay">所选指标评分标准:</label>
                    <div id="rubricsContainer" class="rubrics-display">
                        <p>选择指标以查看对应评分标准（评分标准将包含在PDF中）</p>
                    </div>
                </div>

                <div class="form-group" style="display:none;">
                    <textarea id="Rubrics"></textarea>
                </div>
            </div>

            <!-- 自定义评分标准 -->
            <div class="app-card">
                <div class="card-header">
                    <div class="card-icon"><i class="bi bi-stars"></i></div>
                    <div class="card-title">自定义评分标准</div>
                    <div class="card-counter">5</div>
                </div>
                <div class="mb-3">
                    <button type="button" id="addIndicatorBtn" class="btn btn-primary">
                        <i class="bi bi-plus-circle"></i> 添加指标
                    </button>
                </div>
                <div id="customRubricsContainer">
                    <!-- 指标将在这里动态添加 -->
                </div>
                <div class="form-group mt-3">
                    <button type="button" id="aiEditButton7" class="btn-ai" data-target="customRubricsContainer">
                        <i class="bi bi-magic"></i> AI优化自定义评分标准
                    </button>
                    <span id="aiEditSpinner7" class="ai-progress" style="display:none;">
                        <span class="spinner"></span> 优化中...
                    </span>
                    <textarea id="customRubricsAiSuggestion" name="customRubricsAiSuggestion" class="form-control mt-2" rows="5" style="display: none;" placeholder="AI生成的自定义评分标准建议将显示在此处。"></textarea>
                    <button type="button" id="applyCustomRubricsAiSuggestion" class="btn btn-success mt-2" style="display: none;">应用建议</button>
                </div>
            </div>

            <!-- Button Area -->
            <div class="btn-group">
                <button type="button" id="saveButton" class="btn btn-outline">
                    <i class="bi bi-save"></i> 保存草稿
                </button>
                <button type="button" id="restartButton" class="btn btn-outline">
                    <i class="bi bi-arrow-counterclockwise"></i> 重置
                </button>
                <button type="button" id="downloadPdfButton" class="btn btn-primary">
                    <i class="bi bi-file-earmark-pdf"></i> 下载PDF
                </button>
            </div>
        </form>
    </div>

    <svg class="bottom-wave" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 180">
        <path fill="#64b5f6" fill-opacity="0.5" d="M0,32L48,37.3C96,43,192,53,288,69.3C384,85,480,107,576,101.3C672,96,768,64,864,69.3C960,75,1056,117,1152,122.7C1248,128,1344,96,1392,80L1440,64L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
    </svg>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-base64/3.7.2/base64.min.js"></script>
    <script src="https://lib.youware.com/youware-lib.1747145198.js" id="yourware-lib"></script>
    <script src="standards.js"></script>
    <script src="script.js"></script>
</body>
</html>